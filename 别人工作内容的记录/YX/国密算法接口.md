### 国密算法对外接口



#### 密钥相关

- **服务器默认保存一个对称密钥**

- **服务器默认保存一对非对称密钥**（公钥文件、私钥文件）


##### 	生成对称加密密钥

```
方法：gm.generateSM4Key
```

  请求：

```
{
    "id":"xxx",
    "jsonrpc": "2.0",
    "method":"gm.generateSM4Key",
    "params":{}
}
```

  响应：

```
{
    "id": "xxx",
    "result": {
    	"key"："xxxx"	//对称密钥字符串（Hex）
    },
    "jsonrpc": "2.0"
}
```

##### 	生成非对称密钥

```
方法：gm.generateKeyPair
```

请求：

```
{
    "id":"xxx",
    "jsonrpc": "2.0",
    "method":"gm.generateKeyPair",
    "params":{}
}
```

响应：

```
{
    "id": "xxx",
    "result": {
    	"prikey"："xxxx"		//私钥字符串（Hex）
    	"pubKey": "xxxx"	//公钥字符串（Hex）
    },
    "jsonrpc": "2.0"
}
```

##### 生成自签名证书

```
方法：gm.generateCert
```

请求：

| 字段     | 类型   | 必传                             | 描述                                                         |
| -------- | ------ | -------------------------------- | ------------------------------------------------------------ |
| type     | int    | Y（默认为0）                     | 生成证书的格式<br />0：cer（证书只含公钥）<br />1：pfx（pkcs#12标准，含公私钥） |
| password | String | type==0时不传<br />type==1时必传 | 当生成pfx格式证书时，需要设置一个文件密码                    |

```
{
    "id":"xxx",
    "jsonrpc": "2.0",
    "method":"gm.generateCert",
    "params":{
    	"type": 1，		//证书格式
    	"password":	"xxxx"	//证书密码
    }
}
```

响应：

```
{
    "id": "xxx",
    "result": {	
		"binBase64": "xxx"	//证书base64编码后内容
    },
    "jsonrpc": "2.0"
}
```

> .pfx证书是采用PKCS12标准（证书与公、私钥打包成一个文件）

> .cer证书只包含公钥（公钥为服务器默认公钥）

##### 解析证书文件，提取公钥或私钥

```
方法：gm.parseCert
```

请求：

| 字段      | 类型   | 必传                         | 描述                                             |
| --------- | ------ | ---------------------------- | ------------------------------------------------ |
| type      | int    | Y                            | 证书类型<br />0：cer格式证书<br />1：pfx格式证书 |
| binBase64 | String | Y                            | 证书文件Base64编码                               |
| password  | String | type==0不传<br />type==1必传 | 解析证书文件的密码                               |

```
{
    "id":"xxx",
    "jsonrpc": "2.0",
    "method":"gm.parseCert",
    "params":{
    	"type": 1，		//证书格式类型
    	"binBase64": "XXX"	//证书base64编码
    	"password":	"xxxx"	//证书密码
    }
}
```

响应：

```
{
    "id": "xxx",
    "result": {	
		"pubKey": "xxx"	//提取出来的公钥（Hex）
		"priKey": "xxx"	//提取出来的私钥（Hex）
    },
    "jsonrpc": "2.0"
}
```



#### 加解密相关



##### 	对称加解密

```
方法：gm.symmetryEncrptOrDecrypt
```

请求：

| 字段    | 类型   | 必传 | 描述                                       |
| ------- | ------ | ---- | ------------------------------------------ |
| srcData | String | Y    | 指定数据                                   |
| mode    | int    | Y    | 加解密模式<br />0：加密<br />1：解密       |
| key     | String | N    | 密钥（可选，无传入则使用系统默认对称密钥） |

```
{
    "id":"xxx",
    "jsonrpc": "2.0",
    "method":"gm.symmetryEncrptOrDecrypt",
    "params":{
    	"mode": 1,			//加解密类型
    	"srcData": "XXX",	//指定数据
    	"key":	"xxxx"		//密钥
    }
}
```

响应：

```
{
    "id": "xxx",
    "result": {	
		"content": "xxx"	//加解密后的数据
    },
    "jsonrpc": "2.0"
}
```

##### 非对称加解密

```
方法：gm.asymetryEncryptOrDecrypt
```

  请求：

| 字段    | 类型   | 必传 | 描述                                         |
| ------- | ------ | ---- | -------------------------------------------- |
| srcData | String | Y    | 指定数据                                     |
| mode    | int    | Y    | 加解密模式                                   |
| keyType | int    | Y    | 密钥类型<br />0：公钥<br />1：私钥           |
| key     | String | N    | 密钥（可选，不传入则使用系统默认公钥或私钥） |

```
{
    "id":"xxx",
    "jsonrpc": "2.0",
    "method":"gm.asymetryEncryptOrDecrypt",
    "params":{
    	"mode": 1，			//加解密类型
    	"srcData": "XXX"，	//指定数据
    	"keyType": 0，		//密钥类型
    	"key":	"xxxx"		//密钥
    }
}
```

响应：

```
{
    "id": "xxx",
    "result": {	
		"content": "xxx"	//加解密后的数据
    },
    "jsonrpc": "2.0"
}

```



#### 签名相关



##### 	生成摘要

```
方法：gm.generateDigest
```

请求：

| 字段    | 类型   | 必传 | 描述     |
| ------- | ------ | ---- | -------- |
| srcData | String | Y    | 指定数据 |

```
{
    "id":"xxx",
    "jsonrpc": "2.0",
    "method":"gm.generateDigest",
    "params":{
		"srcData": "xxx"	//指定数据
    }
}
```

响应：

```
{
    "id": "xxx",
    "result": {	
		"digest": "xxx"		//摘要
    },
    "jsonrpc": "2.0"
}

```

##### 生成签名

```
方法：gm.generateSign
```

请求：

| 字段    | 类型   | 必传 | 描述                                       |
| ------- | ------ | ---- | ------------------------------------------ |
| srcData | String | Y    | 原始数据                                   |
| keyType | int    | Y    | 密钥类型<br />0：公钥<br />1：私钥         |
| key     | String | N    | 密钥（可选，不传则使用系统默认公钥或私钥） |

```
{
    "id":"xxx",
    "jsonrpc": "2.0",
    "method":"gm.generateSign",
    "params":{
		"srcData": "xxx"	//指定数据
		"keyType": 1		//密钥类型
		"key": "xxx"		//密钥
    }
}
```

响应：

```
{
    "id": "xxx",
    "result": {	
		"sign": "xxx"		//签名
    },
    "jsonrpc": "2.0"
}
```

##### 验签

```
方法：gm.verifySign
```

请求：

| 字段    | 类型   | 必传 | 描述                                             |
| ------- | ------ | ---- | ------------------------------------------------ |
| srcData | String | Y    | 原始数据                                         |
| sign    | String | Y    | 签名数据                                         |
| keyType | int    | Y    | 密钥类型<br />0：公钥<br />1：私钥               |
| key     | String | N    | 密钥（可选，无传入则使用系统默认的公钥或者私钥） |

```
{
    "id":"xxx",
    "jsonrpc": "2.0",
    "method":"gm.verifySign",
    "params":{
		"srcData": "xxx"	//原始数据
		"sign": "xxx"		//签名数据
		"keyType": 1		//密钥类型
		"key": "xxx"		//密钥
    }
}
```

响应：

```
{
    "id": "xxx",
    "result": {	
		"verificationResult": true	//验证成功或失败
    },
    "jsonrpc": "2.0"
}
```

